<section class="recipes">
  <a href="#" class="js-next" data-id="<%=@recipe.id%>">Next...</a>
  <h3 class="recipeName"><%= @recipe.name %></h3>
  <p class="recipePrep">Prep Time:
    <%= @recipe.prep_time %>
    minutes
  </p>
  <p class="recipeCook">Cook Time:
    <%= @recipe.cook_time %>
    minutes
  </p>
  <%= render 'ingredients/list_ingredients', recipe: @recipe %>
  <h3 class="recipeBody">Instructions:</h3>
    <%= @recipe.instructions %>
  <hr>
    <%= render 'reviews/form', review: @recipe.reviews.new, recipe: @recipe %>
    <%= link_to 'Edit Recipe', edit_user_recipe_path(@recipe) %>
    |
    <%= link_to 'Remove Recipe', @recipe, :method => :delete, :confirm => "Are you sure ?"%>
    |
    <%= link_to 'Go Back', recipes_path %>
</section>

<section id="reviews-section">
  <h3>Reviews:</h3>
  <% if @recipe.reviews.present? %>
    <% @recipe.reviews.each do |r| %>
      <h5><strong> <%= r.reviewer %><br><%= r.description %></strong><br><%= r.difficulty %><hr></h5>
    <% end %>
  <% end %>
</section>

<script type="text/javascript" charset="utf-8">
$(function () {
  $(".js-next").on("click", function(e) {
    var nextId = parseInt($(".js-next").attr("data-id")) + 1;
    $.getJSON("/recipes/" + nextId + "/recipe_data", function(data) {
      $(".recipeName").text(data["recipe"]["name"]);
      $(".recipePrep").text(data["prep_time"]);
      $(".recipeCook").text(data["cook_time"]);
      $(".recipeBody").text(data["instructions"]);
      // re-set the id to current on the link
      $(".js-next").attr("data-id", data["id"]);
    });
    e.preventDefault();
  });
});
</script>
